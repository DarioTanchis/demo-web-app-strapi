"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4263],{19150:function(C,l,e){e.d(l,{R:function(){return o}});var t=e(19565),a=e(33348),n=e(20108);function o(u={},i={}){const{id:s="",...d}=u,c=(0,a.stringify)(d,{encode:!1}),{get:m}=(0,t.kY)(),{data:r,isError:p,isLoading:O,refetch:A}=(0,n.useQuery)(["users",s,d],async()=>{const{data:{data:h}}=await m(`/admin/users/${s}${c?`?${c}`:""}`);return h},i);let E=[];return s&&r?E=[r]:Array.isArray(r?.results)&&(E=r.results),{users:E,pagination:r?.pagination??null,isLoading:O,isError:p,refetch:A}}},40874:function(C,l,e){e.r(l),e.d(l,{default:function(){return re}});var t=e(32735),a=e(19565),n=e(15062),o=e(53038),u=e(78125),i=e(20011),s=e(27649),d=e(82055),c=e(41415),m=e(17e3),r=e(72850),p=e(87933),O=e(49372),A=e(15335),E=e(5803),h=e(66456),I=e(29439),w=e(92802),j=e(33795),x=e.n(j),N=e(9086),T=e.n(N),Y=e(88423),z=e.n(Y),F=e(60216),H=e.n(F),b=e(67879),v=e(19150),V=e(8997),q=e(4397),ee=e(1057);const te=async(R,P)=>{const{put:f}=(0,a.tg)(),{data:y}=await f(`/admin/users/${R}`,P);return y.data};var ae=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]];const se=(()=>window&&window.strapi&&window.strapi.isEE?e(28890).Z:e(16325).Z)(),Q=["email","firstname","lastname","username","isActive","roles"],X=R=>{let{canUpdate:P}=R;const{formatMessage:f}=(0,b.Z)(),{params:{id:y}}=(0,o.$B)("/settings/users/:id"),{push:K}=(0,o.k6)(),{setUserDisplayName:B}=(0,a.L7)(),Z=(0,a.lm)(),{lockApp:G,unlockApp:oe}=(0,a.o1)();(0,a.go)();const{users:[S],isLoading:J}=(0,v.R)({id:y},{onError(g){const{status:M}=g.response;M===403?(Z({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),K("/")):Z({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),ie=async(g,M)=>{G();try{const L=await te(y,T()(g,"confirmPassword"));Z({type:"success",message:f({id:"notification.success.saved",defaultMessage:"Saved"})});const D=a.I8.getUserInfo();if(y.toString()===D.id.toString()){a.I8.setUserInfo(L);const W=x()(g,"username")||(0,V.Pp)(g.firstname,g.lastname);B(W)}M.setValues(z()(g,Q))}catch(L){const D=(0,V.Iz)(L.response.data),W=Object.keys(D).reduce((_,U)=>(_[U]=D[U].id,_),{});M.setErrors(W),Z({type:"warning",message:x()(L,"response.data.error.message","notification.error")})}oe()},le=J?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},$=Object.keys(z()(S,Q)).reduce((g,M)=>M==="roles"?(g[M]=(S?.roles||[]).map(L=>{let{id:D}=L;return D}),g):(g[M]=S?.[M],g),{}),de=$.username||(0,V.Pp)($.firstname,$.lastname),k=f(le,{name:de});return J?t.createElement(s.o,{"aria-busy":"true"},t.createElement(a.SL,{name:"Users"}),t.createElement(d.T,{primaryAction:t.createElement(c.z,{disabled:!0,startIcon:t.createElement(h.Z,null),type:"button",size:"L"},f({id:"global.save",defaultMessage:"Save"})),title:k,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(I.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},f({id:"global.back",defaultMessage:"Back"}))}),t.createElement(m.D,null,t.createElement(a.dO,null))):t.createElement(s.o,null,t.createElement(a.SL,{name:"Users"}),t.createElement(w.J9,{onSubmit:ie,initialValues:$,validateOnChange:!1,validationSchema:ee.YM},g=>{let{errors:M,values:L,handleChange:D,isSubmitting:W}=g;return t.createElement(a.l0,null,t.createElement(d.T,{primaryAction:t.createElement(c.z,{disabled:W||!P,startIcon:t.createElement(h.Z,null),loading:W,type:"submit",size:"L"},f({id:"global.save",defaultMessage:"Save"})),title:k,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(I.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},f({id:"global.back",defaultMessage:"Back"}))}),t.createElement(m.D,null,S?.registrationToken&&t.createElement(r.x,{paddingBottom:6},t.createElement(se,{registrationToken:S.registrationToken})),t.createElement(p.k,{direction:"column",alignItems:"stretch",gap:7},t.createElement(r.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(p.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(O.Z,{variant:"delta",as:"h2"},f({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),t.createElement(A.r,{gap:5},ae.map(_=>_.map(U=>t.createElement(E.P,(0,i.Z)({key:U.name},U.size),t.createElement(a.jm,(0,i.Z)({},U,{disabled:!P,error:M[U.name],onChange:D,value:L[U.name]||""})))))))),t.createElement(r.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(p.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(O.Z,{variant:"delta",as:"h2"},f({id:"global.roles",defaultMessage:"User's role"})),t.createElement(A.r,{gap:5},t.createElement(E.P,{col:6,xs:12},t.createElement(q.Z,{disabled:!P,error:M.roles,onChange:D,value:L.roles}))))))))}))};X.propTypes={canUpdate:H().bool.isRequired};var ne=X,re=()=>{const R=(0,a.lm)(),P=(0,n.v9)(u._),f=t.useMemo(()=>({read:P.settings.users.read,update:P.settings.users.update}),[P.settings.users]),{isLoading:y,allowedActions:{canRead:K,canUpdate:B}}=(0,a.ss)(f),{state:Z}=(0,o.TH)(),G=Z?.from??"/";return(0,t.useEffect)(()=>{y||!K&&!B&&R({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[y,K,B,R]),y?t.createElement(a.dO,null):!K&&!B?t.createElement(o.l_,{to:G}):t.createElement(ne,{canUpdate:B})}},76779:function(C,l,e){var t=e(32735),a=e(50563),n=e(19565),o=e(47765),u=e(60216),i=e.n(u),s=e(67879);const d=({children:c,target:m})=>{const r=(0,n.lm)(),{formatMessage:p}=(0,s.Z)(),{copy:O}=(0,n.VP)(),A=p({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),E=async()=>{await O(m)&&r({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(n.Y_,{endAction:t.createElement(a.h,{label:A,noBorder:!0,icon:t.createElement(o.Z,null),onClick:E}),title:m,titleEllipsis:!0,subtitle:c,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};d.propTypes={children:i().oneOfType([i().element,i().string]).isRequired,target:i().string.isRequired},l.Z=d},16325:function(C,l,e){var t=e(32735),a=e(60216),n=e.n(a),o=e(67879),u=e(78246),i=e(76779);const s=({registrationToken:d})=>{const{formatMessage:c}=(0,o.Z)(),m=`${window.location.origin}${u.Z}auth/register?registrationToken=${d}`;return t.createElement(i.Z,{target:m},c({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:n().string},l.Z=s},4397:function(C,l,e){var t=e(32735),a=e(68465),n=e(84967),o=e(19565),u=e(27169),i=e(60216),s=e.n(i),d=e(67879),c=e(20108),m=e(8471);const r=m.F4`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,p=m.ZP.div`
  animation: ${r} 2s infinite linear;
`,O=()=>t.createElement(p,null,t.createElement(u.Z,null)),A=async()=>{const{get:h}=(0,o.tg)(),{data:I}=await h("/admin/roles");return I.data},E=({disabled:h,error:I,onChange:w,value:j})=>{const{status:x,data:N}=(0,c.useQuery)(["roles"],A,{staleTime:5e4}),{formatMessage:T}=(0,d.Z)(),Y=I?T({id:I,defaultMessage:I}):"",z=T({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),F=T({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),H=T({id:"app.components.Select.placeholder",defaultMessage:"Select"}),b=x==="loading"?t.createElement(O,null):void 0;return t.createElement(a.P,{id:"roles",disabled:h,error:Y,hint:F,label:z,name:"roles",onChange:v=>{w({target:{name:"roles",value:v}})},placeholder:H,multi:!0,startIcon:b,value:j.map(v=>v.toString()),withTags:!0,required:!0},(N||[]).map(v=>t.createElement(n.W,{key:v.id,value:v.id.toString()},T({id:`global.${v.code}`,defaultMessage:v.name}))))};E.defaultProps={disabled:!1,error:void 0},E.propTypes={disabled:s().bool,error:s().string,onChange:s().func.isRequired,value:s().array.isRequired},l.Z=E},1057:function(C,l,e){e.d(l,{YM:function(){return c},Rw:function(){return u}});var t=e(24346),a=e(19565);const n={firstname:t.Z_().trim().required(a.I0.required),lastname:t.Z_(),email:t.Z_().email(a.I0.email).lowercase().required(a.I0.required),username:t.Z_().nullable(),password:t.Z_().min(8,a.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:t.Z_().min(8,a.I0.minLength).oneOf([t.iH("password"),null],"components.Input.error.password.noMatch").when("password",(m,r)=>m?r.required(a.I0.required):r)};var u={...n,currentPassword:t.Z_().when(["password","confirmPassword"],(m,r,p)=>m||r?p.required(a.I0.required):p),preferedLanguage:t.Z_().nullable()},s={roles:t.IX().min(1,a.I0.required).required(a.I0.required)},c=t.Ry().shape({...n,isActive:t.Xg(),...s})},28890:function(C,l,e){var t=e(32735),a=e(60216),n=e.n(a),o=e(67879),u=e(78246),i=e(76779);const s=({registrationToken:d})=>{const{formatMessage:c}=(0,o.Z)();return d?t.createElement(i.Z,{target:`${window.location.origin}${u.Z}auth/register?registrationToken=${d}`},c({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(i.Z,{target:`${window.location.origin}${u.Z}auth/login`},c({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:n().string},l.Z=s},29439:function(C,l,e){e.d(l,{Z:function(){return n}});var t=e(74512);const a=o=>(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...o,children:(0,t.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),n=a}}]);
